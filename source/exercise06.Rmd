---
title: "Statistinės duomenų analizės praktinės užduotys"
date: "2017"
output: pdf_document
---

```{r}
library(knitr)
set.seed(42)
```

6.  __Parametrinių hipotezių tikrinimas.__

   (a) _Hipotezė apie normalaus skirstinio vidurkio reikšmę: Stujudento kriterijus
   vienai normaliajai imčiai_ (ČM III.3.3.4).
   Užkandžiais prekiaujanti firma nusprenė mėsainius su žuvimi pakeisti mėsainiais
   su bananais. Dvylikoje užkandinių per savaitę buvo parduota atitinkamai
   530, 540, 510, 500, 520, 532, 540, 515, 517, 522, 530 ir 510 naujųjų užkandžių.
   Anksčiau kiekviena užkandinė parduodavo vidutiniškai po 520 senųjų užkandžių
   per savaitę. Ar naujoji produkcija blogiau perkama? Reikšmingumo lygmuo 0.05.

```{r}
sales <- c(530, 540, 510, 500, 520, 532,
           540, 515, 517, 522, 530, 510)

mu_0 <- 520
```
   Patikrinkime _normalumo prielaidą_. _Kolmogorovo - Smirnovo kriterijus_:

```{r}
ks.test(sales, pnorm)
```
   _Normalumo prielaida_ galioja. Tikrinkime hipotezę:

   $$H: \mu \leq \mu_0, \mu_0 = 520$$

```{r}
t <- t.test(sales, alternative="g", mu=mu_0, conf.level=.95)
pv <- t$p.value
t
```
   $pv = `r pv` > \alpha = 0.05$, duomenys neprieštarauja hipotezei.
   Statistiškai, naujoji produkcija nėra blogiau perkama (imtis nedidelė).

   (b) _Hipotezė apie proporcijos reikšmę_ (ČM III.3.3.7). Naujo medikamento
   reklamoje teigiama, kad jis sukelia pašalines reakcijas ne daugiau kaip 1
   procentui pacientų . Ištyrus 1000 vaistą vartojusiu ligonių, nustatyta, kad
   pašalini poveikį pajuto 32 ligoniai. Ar duomenys neprieštarauja reklaminiam
   teiginiui? Reikšmingumo lygmuo 0.05.

   Tikrinkime hipotezę

   $$H: p = p_0, p_0 = 0.01 $$

```{r}
proportion.test <- function(p_0, s_n, n, alternative="two.sided") {
  # Hipothesis about proportion value.
  # Returns p-value.

  if (alternative == "two.sided" | alternative == "t"){
    pv <- 2 * min(
                   pbeta(p_0, s_n, n - s_n + 1),
                   1 - pbeta(p_0, s_n + 1, n - s_n)
                 )

  } else if (alternative == "greater" | alternative == "g" ) {
    pv <- pbeta(p_0, s_n, n - s_n + 1)

  } else if (alternative == "less" | alternative == "l") {
    pv <- 1 - pbeta(p_0, s_n + 1, n - s_n)

  } else {
    stop("'alternative' should be one of 'two.sided', 'greater', 'less' or first
         letter of these terms!")
  }

  return(pv)
}

pv <- proportion.test(0.01, 32, 1000)
pv
```

   Čia formulės paiimtos iš `Pratybos1.pdf`. $pv = `r pv` < \alpha = 0.05$.
   Hipotezę $H$ atmetame. Statistiškai, galime teigti, kad duomenys prieštarauja
   reklaminiam teiginiui.

   (c) _Hipotezė apie proporcijos reikšmę_ (ČM III.3.10). Ekonomistas nori
   patikrinti, ar padaugėjo smulkių įmonių (procentais). Prieš dešimt metų jos
   sudarė 20 procentų visų įmonių. Šiuo metu iš 100 atsitiktinai parinktų įmonių
   27 buvo smulkios. Reikšmingumo lygmuo 0.05.

   Tikrinkime hipotezę

   $$H: p \geq p_0, p_0 = 0.2$$

```{r}
pv <- proportion.test(0.2, 27, 100, alternative="l")
pv
```

  $pv = `r pv` > \alpha 0.05$. Hipotezės nėra pagrindo atmesti. Statistiškai,
  smulkių įmonių padaugėjo.

   (d) _Hipotezė apie koreliacijos koeciento lygybę nuliui_ (ČM III.3.13).
   Duomenys apie pardavėjo stažą (metais) ir jo pradinį atlyginimą (sutartiniais
   vienetais) pateikti lentelėje. Ar atlyginimas priklauso nuo pardavėjo stažo?

   | Stažas | Atlyginimas | Stažas | Atlyginimas |
   |--------|-------------|--------|-------------|
   | 2      | 100         | 8      | 500         |
   | 1.5    | 300         | 7      | 400         |
   | 3      | 400         | 5      | 400         |
   | 10     | 600         | 4      | 250         |
   | 12     | 600         | 2      | 200         |
   | 4      | 300         | 1      | 100         |
   | 2      | 100         | 6      | 350         |

```{r}
years <- c(2, 1.5, 3, 10, 12, 4, 2,
           8, 7, 5, 4, 2, 1, 6)
wages <- c(100, 300, 400, 600, 600, 300, 100,
           500, 400, 400, 250, 200, 100, 350)
```

   Tikrinkime hipotezę

   $$H: \rho = 0$$

```{r}
cor <- cor.test(years, wages)
pv <- cor$p.value
cor
```

   $pv = `r pv` < \alpha = 0.05$. Hipotezę atmetame. Statistiškai, koreliacija
   nėra lygi nuliui.

   (e) _Dviejų priklausomų normaliųjų imčių vidurkių palyginimas: Stjudento
   kriterijus._ Tiriamas fizinių pratimų poveikis svoriui. Parenkamos 5 moterys
   ir matuojamas ju svoris prieš ir po fizinių pratimų kurso. Gauti rezultatai:
   84, 97, 77, 91, 85 (prieš) ir 78, 95, 73, 88, 80 (po). Rasti 0.9 pasikliautinį
   intervalą svorių skirtumui ir patikrinti hipotezę: vidutinis svoris nepakinta.


```{r}
before <- c(84, 97, 77, 91, 85)
after <- c(78, 95, 73, 88, 80)

t <- t.test(before, after, paired=TRUE, conf.level=0.9)
pv <- t$p.value
t
```
   $$H: \mu_1 = \mu_2$$

   $pv = `r pv` < \alpha = 0.10$. Hipotezę atmetame. Statistiškai, vidutinis
   svoris pakito.

***
  Padaryta su `r R.Version()$version.string`, `r R.Version()$platform`.
